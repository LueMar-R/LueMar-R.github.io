
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Clustering &amp; Réduction de la dimensionnalité &#8212; Cahier</title>
    
  <link rel="stylesheet" href="../../_static/css/index.f658d18f9b420779cfdf24aa0a7e2d77.css">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="../../_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="../../_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/sphinx-book-theme.e7340bb3dbd8dde6db86f25597f54a1b.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../../_static/js/index.d3f166471bb80abb5163.js">

    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/sphinx-book-theme.7d483ff0a819d6edff12ce0b1ead3928.js"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../../index.html">
  
  <img src="../../_static/accueil.png" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">Cahier</h1>
  
</a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../intro.html">
  </a>
 </li>
</ul>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../cmd.html">
   Commandes DOS
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../notebook_et_markdown.html">
   Notebook et Markdown
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../environnement_virtuel_conda.html">
   Environnement Virtuel Conda
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Maths/Rappel_Notions_Statistiques_Lud.html">
   Rappel des Notions Statistiques
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Maths/SciPy.html">
   SciPy
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Maths/SciPy.html#association-de-population">
   Association de population
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../mysql.html">
   MySql
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../NLP/nlp1.html">
   NLP
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../NLP/nlp2.html">
   NLP
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../NLP/TAL3/Tal_3.html">
   Partie I : Analyse des sentiments des films - Word2Vec
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../NLP/TAL4/Tal_4.html">
   Partie II : Analyse des sentiments des films - Word2Vec (Suite)
  </a>
 </li>
</ul>

</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../_sources/pages/Classification/Clustering_part1.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->


            <!-- Full screen (wrap in <a> to have style consistency -->
            <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                    data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                    title="Fullscreen mode"><i
                        class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/executablebooks/jupyter-book/master?urlpath=tree/pages/Classification/Clustering_part1.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i>
            Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#clustering">
   1- Clustering
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#creez-un-code-qui-partitionne-les-donnees-en-base-dapprentissage-60000-et-base-de-test-10000">
     1. Créez un code qui partitionne les données en base d’apprentissage (60000) et base de test (10000).
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#creez-une-figure-avec-des-sous-graphiques-3x3-en-utilisant-matplotlib-pyplot">
     2. Créez une figure avec des sous-graphiques 3x3 en utilisant matplotlib.pyplot.
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#les-algorithmes-de-clustering-utilisent-presque-toujours-des-donnees-unidimensionnelles">
     3. Les algorithmes de clustering utilisent presque toujours des données unidimensionnelles.
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#il-est-temps-de-commencer-le-clustering">
     4. Il est temps de commencer le clustering!
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#le-k-means-est-une-methode-d-apprentissage-automatique-non-supervisee">
     5. Le K-means est une méthode d’apprentissage automatique non supervisée;
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#avec-les-fonctions-definies-ci-dessus-nous-pouvons-maintenant-determiner-la-precision-de-nos-algorithmes">
     6. Avec les fonctions définies ci-dessus, nous pouvons maintenant déterminer la précision de nos algorithmes.
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#de-plus-precedemment-nous-avons-fait-l-hypothese-que-k-10-etait-le-nombre-approprie-de-clusters">
     7. De plus, précédemment, nous avons fait l’hypothèse que K = 10 était le nombre approprié de clusters;
    </a>
   </li>
  </ul>
 </li>
</ul>

        </nav>
        
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="clustering-reduction-de-la-dimensionnalite">
<h1>Clustering &amp; Réduction de la dimensionnalité<a class="headerlink" href="#clustering-reduction-de-la-dimensionnalite" title="Permalink to this headline">¶</a></h1>
<p>Chargez la base de données MNIST depuis le module scikit-learn
Transformez le type des labels de string en uint8 en utilisant la fonction astype</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">fetch_openml</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">StandardScaler</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span> <span class="nn">sklearn.cluster</span> <span class="kn">import</span> <span class="n">MiniBatchKMeans</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mnist</span> <span class="o">=</span> <span class="n">fetch_openml</span><span class="p">(</span><span class="s1">&#39;mnist_784&#39;</span><span class="p">,</span> <span class="n">version</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X</span> <span class="o">=</span> <span class="n">mnist</span><span class="o">.</span><span class="n">data</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">mnist</span><span class="o">.</span><span class="n">target</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([5, 0, 4, ..., 4, 5, 6], dtype=uint8)
</pre></div>
</div>
</div>
</div>
<div class="section" id="clustering">
<h2>1- Clustering<a class="headerlink" href="#clustering" title="Permalink to this headline">¶</a></h2>
<div class="section" id="creez-un-code-qui-partitionne-les-donnees-en-base-dapprentissage-60000-et-base-de-test-10000">
<h3>1. Créez un code qui partitionne les données en base d’apprentissage (60000) et base de test (10000).<a class="headerlink" href="#creez-un-code-qui-partitionne-les-donnees-en-base-dapprentissage-60000-et-base-de-test-10000" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.14285</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Training matrix shape&quot;</span><span class="p">,</span> <span class="n">X_train</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Testing matrix shape&quot;</span><span class="p">,</span> <span class="n">X_test</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Training matrix shape (60000, 784)
Testing matrix shape (10000, 784)
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="creez-une-figure-avec-des-sous-graphiques-3x3-en-utilisant-matplotlib-pyplot">
<h3>2. Créez une figure avec des sous-graphiques 3x3 en utilisant matplotlib.pyplot.<a class="headerlink" href="#creez-une-figure-avec-des-sous-graphiques-3x3-en-utilisant-matplotlib-pyplot" title="Permalink to this headline">¶</a></h3>
<p>Parcourir
les sous-graphiques et ajouter les 9 premières images mnist en utilisant matshow() et
Afficher le graphique.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">ax</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">axs</span><span class="o">.</span><span class="n">flat</span><span class="p">):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">matshow</span><span class="p">(</span><span class="n">X_train</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">28</span><span class="p">,</span><span class="mi">28</span><span class="p">),</span> <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">binary</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Clustering_part1_10_0.png" src="../../_images/Clustering_part1_10_0.png" />
</div>
</div>
</div>
<div class="section" id="les-algorithmes-de-clustering-utilisent-presque-toujours-des-donnees-unidimensionnelles">
<h3>3. Les algorithmes de clustering utilisent presque toujours des données unidimensionnelles.<a class="headerlink" href="#les-algorithmes-de-clustering-utilisent-presque-toujours-des-donnees-unidimensionnelles" title="Permalink to this headline">¶</a></h3>
<p>Par exemple, si vous regroupiez un ensemble de coordonnées X, Y, chaque point serait
passé à l’algorithme de clustering sous la forme d’un vecteur à une dimension d’une
longueur de deux (exemple: [2,4] ou [-1, 4] ). MNIST contient des images de taille 28x28
pixels; en conséquence, ils auront une longueur de 784 une fois que nous les
transformons en un vecteur à une seule dimension. Convertissez chaque image dans les
données d’apprentissage en un vecteur d’une seule dimension, normalisez ces données
dans un intervalle entre 0 et 1.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span> <span class="o">=</span> <span class="n">X_train</span><span class="o">/</span><span class="mi">255</span><span class="p">,</span> <span class="n">X_test</span><span class="o">/</span><span class="mi">255</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="il-est-temps-de-commencer-le-clustering">
<h3>4. Il est temps de commencer le clustering!<a class="headerlink" href="#il-est-temps-de-commencer-le-clustering" title="Permalink to this headline">¶</a></h3>
<p>En raison de la taille du jeu de données MNIST,
nous utiliserons l’implémentation mini-batch du clustering k-means fourni par scikit-learn.
Cela réduira considérablement le temps nécessaire pour adapter l’algorithme aux
données. Créez un code qui permet de faire l’apprentissage sur les données
d’entraînement normalisées en utilisant l’objet MiniBatchKMeans du sous module cluster
de scikit-learn. Pour le paramètre n_clusters sa valeur est le nombre de classe dans le
jeu de données.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">MiniBatchKMeans</span><span class="p">(</span><span class="n">n_clusters</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="le-k-means-est-une-methode-d-apprentissage-automatique-non-supervisee">
<h3>5. Le K-means est une méthode d’apprentissage automatique non supervisée;<a class="headerlink" href="#le-k-means-est-une-methode-d-apprentissage-automatique-non-supervisee" title="Permalink to this headline">¶</a></h3>
<p>par
conséquent, les étiquettes attribuées par notre algorithme KMeans font référence au
cluster auquel chaque vecteur a été assigné, et non à l’entier cible réel. Pour résoudre ce
problème, définissons quelques fonctions qui prédiront quel entier correspond à chaque
cluster :</p>
<p>a- Définissez une fonction qui associe le label le plus probable à chaque cluster dans
le modèle KMeans et qui renvoie un dictionnaire des clusters assignés à chaque
label.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">attrib_labels</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="n">dico</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">n_clusters</span><span class="p">):</span>

        <span class="c1"># trouver les index</span>
        <span class="n">labels</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">labels_</span> <span class="o">==</span> <span class="n">i</span><span class="p">)</span>

        <span class="c1"># rajouter les labels de chaque point du cluster</span>
        <span class="n">labels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="n">index</span><span class="p">])</span>

        <span class="c1"># chercher le label le plus courant</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">labels</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">compte</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">bincount</span><span class="p">(</span><span class="n">labels</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">compte</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">bincount</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">labels</span><span class="p">))</span>

        <span class="c1"># assigner les clusters à une valeur du dictionnaire</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">compte</span><span class="p">)</span> <span class="ow">in</span> <span class="n">dico</span><span class="p">:</span>
            <span class="c1"># ajouter le nouveau numéro au array</span>
            <span class="n">dico</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">compte</span><span class="p">)]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># créer un nouvel array</span>
            <span class="n">dico</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">compte</span><span class="p">)]</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">dico</span>

<span class="k">def</span> <span class="nf">labels_data</span><span class="p">(</span><span class="n">X_labels</span><span class="p">,</span> <span class="n">cluster_labels</span><span class="p">):</span>
  <span class="c1"># array vide de longueur: len(X)</span>
    <span class="n">pred_label</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">X_labels</span><span class="p">))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">cluster</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">X_labels</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">cluster_labels</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">cluster</span> <span class="ow">in</span> <span class="n">value</span><span class="p">:</span>
                <span class="n">pred_label</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">key</span>

    <span class="k">return</span> <span class="n">pred_label</span>

<span class="c1"># lancer les fonctions</span>
<span class="n">cluster_labels</span> <span class="o">=</span> <span class="n">attrib_labels</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="n">X_clusters</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
<span class="n">predicted_labels</span> <span class="o">=</span> <span class="n">labels_data</span><span class="p">(</span><span class="n">X_clusters</span><span class="p">,</span> <span class="n">cluster_labels</span><span class="p">)</span>
<span class="nb">print</span> <span class="p">(</span><span class="n">predicted_labels</span><span class="p">[:</span><span class="mi">20</span><span class="p">])</span>
<span class="nb">print</span> <span class="p">(</span><span class="n">y</span><span class="p">[:</span><span class="mi">20</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">TypeError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">125</span><span class="o">-</span><span class="mi">8935</span><span class="n">be7af040</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="g g-Whitespace">     </span><span class="mi">39</span> 
<span class="g g-Whitespace">     </span><span class="mi">40</span> <span class="c1"># lancer les fonctions</span>
<span class="ne">---&gt; </span><span class="mi">41</span> <span class="n">cluster_labels</span> <span class="o">=</span> <span class="n">attrib_labels</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">42</span> <span class="n">X_clusters</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">43</span> <span class="n">predicted_labels</span> <span class="o">=</span> <span class="n">labels_data</span><span class="p">(</span><span class="n">X_clusters</span><span class="p">,</span> <span class="n">cluster_labels</span><span class="p">)</span>

<span class="nn">&lt;ipython-input-125-8935be7af040&gt;</span> in <span class="ni">attrib_labels</span><span class="nt">(model, y)</span>
<span class="g g-Whitespace">     </span><span class="mi">15</span>             <span class="n">compte</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">bincount</span><span class="p">(</span><span class="n">labels</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="g g-Whitespace">     </span><span class="mi">16</span>         <span class="k">else</span><span class="p">:</span>
<span class="ne">---&gt; </span><span class="mi">17</span>             <span class="n">compte</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">bincount</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">labels</span><span class="p">))</span>
<span class="g g-Whitespace">     </span><span class="mi">18</span> 
<span class="g g-Whitespace">     </span><span class="mi">19</span>         <span class="c1"># assigner les clusters à une valeur du dictionnaire</span>

<span class="nn">&lt;__array_function__ internals&gt;</span> in <span class="ni">bincount</span><span class="nt">(*args, **kwargs)</span>

<span class="ne">TypeError</span>: Cannot cast array data from dtype(&#39;O&#39;) to dtype(&#39;int64&#39;) according to the rule &#39;safe&#39;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">attrib_label</span><span class="p">(</span><span class="n">modele</span><span class="p">):</span>
    <span class="n">dico</span> <span class="o">=</span><span class="p">{}</span>
    <span class="n">labels</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span> <span class="c1">#10 clusters car 10 labels</span>
        <span class="n">j</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">modele</span><span class="o">.</span><span class="n">labels_</span> <span class="o">==</span> <span class="n">i</span><span class="p">)</span> <span class="c1">#lignes où le numéro de cluster est égal à i</span>
        <span class="n">labels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">y_train</span><span class="p">[</span><span class="n">j</span><span class="p">])</span> <span class="c1">#ajouter à cette liste les vrais chiffres correspondant à ces lignes</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&gt;&gt;&gt;&gt;&quot;</span><span class="p">,</span> <span class="n">y_train</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&gt;&quot;</span><span class="p">,</span> <span class="n">labels</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
  <span class="c1">#      if len(labels[0]) == 1:</span>
   <span class="c1">#         compteur = np.bincount(labels[0])</span>
    <span class="c1">#        print(compteur)</span>
     <span class="c1">#   else:</span>
        <span class="n">reduit</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">reduit</span><span class="p">)</span>
        <span class="n">compteur</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">bincount</span><span class="p">(</span><span class="n">reduit</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">compteur</span><span class="p">)</span> <span class="ow">in</span> <span class="n">dico</span><span class="p">:</span>
            <span class="n">dico</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">compteur</span><span class="p">)]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">dico</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">compteur</span><span class="p">)]</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span><span class="p">]</span>
            
    <span class="k">return</span> <span class="n">dico</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">attrib_label</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&gt;&gt;&gt;&gt; [&#39;3&#39; &#39;3&#39; &#39;2&#39; ... &#39;3&#39; &#39;5&#39; &#39;3&#39;]
&gt; [&#39;3&#39; &#39;3&#39; &#39;2&#39; ... &#39;3&#39; &#39;5&#39; &#39;3&#39;]
[&#39;3&#39; &#39;3&#39; &#39;2&#39; ... &#39;3&#39; &#39;5&#39; &#39;3&#39;]
</pre></div>
</div>
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">TypeError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">102</span><span class="o">-</span><span class="mf">7e45095</span><span class="n">de030</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">attrib_label</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>

<span class="nn">&lt;ipython-input-101-d4878bc233a1&gt;</span> in <span class="ni">attrib_label</span><span class="nt">(modele)</span>
<span class="g g-Whitespace">     </span><span class="mi">13</span>         <span class="n">reduit</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">14</span>         <span class="nb">print</span><span class="p">(</span><span class="n">reduit</span><span class="p">)</span>
<span class="ne">---&gt; </span><span class="mi">15</span>         <span class="n">compteur</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">bincount</span><span class="p">(</span><span class="n">reduit</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">16</span>         <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">compteur</span><span class="p">)</span> <span class="ow">in</span> <span class="n">dico</span><span class="p">:</span>
<span class="g g-Whitespace">     </span><span class="mi">17</span>             <span class="n">dico</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">compteur</span><span class="p">)]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>

<span class="nn">&lt;__array_function__ internals&gt;</span> in <span class="ni">bincount</span><span class="nt">(*args, **kwargs)</span>

<span class="ne">TypeError</span>: Cannot cast array data from dtype(&#39;O&#39;) to dtype(&#39;int64&#39;) according to the rule &#39;safe&#39;
</pre></div>
</div>
</div>
</div>
<p>b- Définissez une fonction qui détermine le label de chaque vecteur, en fonction du
cluster auquel il a été affecté et qui renvoie les labels prédites pour chaque
vecteur.</p>
</div>
<div class="section" id="avec-les-fonctions-definies-ci-dessus-nous-pouvons-maintenant-determiner-la-precision-de-nos-algorithmes">
<h3>6. Avec les fonctions définies ci-dessus, nous pouvons maintenant déterminer la précision de nos algorithmes.<a class="headerlink" href="#avec-les-fonctions-definies-ci-dessus-nous-pouvons-maintenant-determiner-la-precision-de-nos-algorithmes" title="Permalink to this headline">¶</a></h3>
<p>Puisque nous utilisons cet algorithme de clustering pour la
classification, la précision est finalement la métrique la plus importante; cependant, il
existe d’autres mesures qui peuvent être appliquées directement aux clusters euxmêmes,
quelles que soient les labels associés. Deux de ces métriques que nous
utiliserons sont l’inertie et l’homogénéité.</p>
</div>
<div class="section" id="de-plus-precedemment-nous-avons-fait-l-hypothese-que-k-10-etait-le-nombre-approprie-de-clusters">
<h3>7. De plus, précédemment, nous avons fait l’hypothèse que K = 10 était le nombre approprié de clusters;<a class="headerlink" href="#de-plus-precedemment-nous-avons-fait-l-hypothese-que-k-10-etait-le-nombre-approprie-de-clusters" title="Permalink to this headline">¶</a></h3>
<p>cependant, ce n’est peut-être pas le cas. Ajustez l’algorithme de clustering Kmeans
avec plusieurs valeurs différentes de K (ex : [10, 16, 36, 64, 144, 256]), puis
évaluez les performances à l’aide de ces métriques.</p>
<p><a class="reference external" href="https://github.com/xoraus/K-Means-Clustering-for-Imagery-Analysis/blob/master/KMeans%20Clustering%20for%20Imagery%20Analysis%20(Jupyter%20Notebook).ipynb">https://github.com/xoraus/K-Means-Clustering-for-Imagery-Analysis/blob/master/KMeans Clustering for Imagery Analysis (Jupyter Notebook).ipynb</a></p>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./pages\Classification"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
        <div class='prev-next-bottom'>
            

        </div>
        
        </div>
    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By The Jupyter Book community<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="../../_static/js/index.d3f166471bb80abb5163.js"></script>


    
  </body>
</html>