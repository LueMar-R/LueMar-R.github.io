
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>&lt;no title&gt; &#8212; Cahier</title>
    
  <link rel="stylesheet" href="../../../_static/css/index.f658d18f9b420779cfdf24aa0a7e2d77.css">

    
  <link rel="stylesheet"
    href="../../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="../../../_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="../../../_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/sphinx-book-theme.e7340bb3dbd8dde6db86f25597f54a1b.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../../../_static/js/index.d3f166471bb80abb5163.js">

    <script id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/togglebutton.js"></script>
    <script src="../../../_static/clipboard.min.js"></script>
    <script src="../../../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../../_static/sphinx-book-theme.7d483ff0a819d6edff12ce0b1ead3928.js"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../../../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../../../index.html">
  
  <img src="../../../_static/accueil.png" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">Cahier</h1>
  
</a>
</div><form class="bd-search d-flex align-items-center" action="../../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../../intro.html">
  </a>
 </li>
</ul>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../cmd.html">
   Commandes DOS
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../notebook_et_markdown.html">
   Notebook et Markdown
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../environnement_virtuel_conda.html">
   Environnement Virtuel Conda
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Maths/Rappel_Notions_Statistiques_Lud.html">
   Rappel des Notions Statistiques
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Maths/SciPy.html">
   SciPy
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Maths/SciPy.html#association-de-population">
   Association de population
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../mysql.html">
   MySql
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../nlp1.html">
   NLP
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../nlp2.html">
   NLP
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Tal_3.html">
   Partie I : Analyse des sentiments des films - Word2Vec
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../TAL4/Tal_4.html">
   Partie II : Analyse des sentiments des films - Word2Vec (Suite)
  </a>
 </li>
</ul>

</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../../_sources/pages/NLP/TAL3/Untitled.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->


            <!-- Full screen (wrap in <a> to have style consistency -->
            <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                    data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                    title="Fullscreen mode"><i
                        class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/executablebooks/jupyter-book/master?urlpath=tree/pages/NLP/TAL3/Untitled.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../../../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i>
            Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="simple nav section-nav flex-column">
</ul>

        </nav>
        
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">string</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">phrases</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;J&#39;ai acheté des tomates&quot;</span><span class="p">,</span>
          <span class="s2">&quot;La saison des oignons arrive&quot;</span><span class="p">,</span>
          <span class="s1">&#39;Cette mangue est très bonne&#39;</span><span class="p">,</span>
          <span class="s1">&#39;Ca sent les haricots&#39;</span><span class="p">,</span>
          <span class="s1">&#39;Je crois que je vais tomber dans les pommes&#39;</span><span class="p">,</span>
          <span class="s1">&#39;Penses à acheter des carottes&#39;</span><span class="p">,</span>
          <span class="s2">&quot;Un petit jus orange?&quot;</span><span class="p">,</span>
          <span class="s2">&quot;Ces fraises sont belles&quot;</span><span class="p">,</span>
          <span class="s2">&quot;Prend des aubergines aussi&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">nltk</span>
<span class="n">nltk</span><span class="o">.</span><span class="n">download</span><span class="p">(</span><span class="s1">&#39;punkt&#39;</span><span class="p">)</span>
<span class="n">tokenizer</span> <span class="o">=</span> <span class="n">nltk</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;nltk:tokenizers/punkt/english.pickle&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[nltk_data] Downloading package punkt to
[nltk_data]     C:\Users\utilisateur\AppData\Roaming\nltk_data...
[nltk_data]   Package punkt is already up-to-date!
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">pretraitement</span><span class="p">(</span><span class="n">text</span><span class="p">):</span>
    <span class="n">text</span> <span class="o">=</span> <span class="n">tokenizer</span><span class="o">.</span><span class="n">tokenize</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
    <span class="n">tmp</span><span class="o">=</span><span class="p">[]</span>
    <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">text</span><span class="p">:</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s2">&quot;^\d+\s|\s\d+\s|\s\d+$&quot;</span><span class="p">,</span> <span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s2">&quot;&lt;/ br&gt;&quot;</span><span class="p">,</span> <span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s2">&quot;&lt;br /&gt;&quot;</span><span class="p">,</span> <span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>  
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">string</span><span class="o">.</span><span class="n">punctuation</span><span class="p">:</span>
            <span class="n">p</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s2">&quot;¨&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)</span>
        <span class="n">p</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">filter</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">p</span><span class="p">))</span>
        <span class="n">tmp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">tmp</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ph</span> <span class="o">=</span><span class="s2">&quot; </span><span class="se">\&quot;</span><span class="s2">The Classic War of the Worlds</span><span class="se">\&quot;</span><span class="s2"> by Timothy Hines is a very entertaining film that obviously goes to great effort and lengths to faithfully recreate H. G. Wells&#39; classic book. Mr. Hines succeeds in doing so. I, and those who watched his film with me, appreciated the fact that it was not the standard, predictable Hollywood fare that comes out every year, e.g. the Spielberg version with Tom Cruise that had only the slightest resemblance to the book. Obviously, everyone looks for different things in a movie. Those who envision themselves as amateur </span><span class="se">\&quot;</span><span class="s2">critics</span><span class="se">\&quot;</span><span class="s2"> look only to criticize everything they can. Others rate a movie on more important bases,like being entertained, which is why most people never agree with the </span><span class="se">\&quot;</span><span class="s2">critics</span><span class="se">\&quot;</span><span class="s2">. We enjoyed the effort Mr. Hines put into being faithful to H.G. Wells&#39; classic novel, and we found it to be very entertaining. This made it easy to overlook what the </span><span class="se">\&quot;</span><span class="s2">critics</span><span class="se">\&quot;</span><span class="s2"> perceive to be its shortcomings.&quot;</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p2</span> <span class="o">=</span> <span class="n">pretraitement</span><span class="p">(</span><span class="n">ph</span><span class="p">)</span>
<span class="n">p2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[&#39;the&#39;,
  &#39;classic&#39;,
  &#39;war&#39;,
  &#39;of&#39;,
  &#39;the&#39;,
  &#39;worlds&#39;,
  &#39;by&#39;,
  &#39;timothy&#39;,
  &#39;hines&#39;,
  &#39;is&#39;,
  &#39;a&#39;,
  &#39;very&#39;,
  &#39;entertaining&#39;,
  &#39;film&#39;,
  &#39;that&#39;,
  &#39;obviously&#39;,
  &#39;goes&#39;,
  &#39;to&#39;,
  &#39;great&#39;,
  &#39;effort&#39;,
  &#39;and&#39;,
  &#39;lengths&#39;,
  &#39;to&#39;,
  &#39;faithfully&#39;,
  &#39;recreate&#39;,
  &#39;h&#39;,
  &#39;g&#39;,
  &#39;wells&#39;,
  &#39;classic&#39;,
  &#39;book&#39;],
 [&#39;mr&#39;, &#39;hines&#39;, &#39;succeeds&#39;, &#39;in&#39;, &#39;doing&#39;, &#39;so&#39;],
 [&#39;i&#39;,
  &#39;and&#39;,
  &#39;those&#39;,
  &#39;who&#39;,
  &#39;watched&#39;,
  &#39;his&#39;,
  &#39;film&#39;,
  &#39;with&#39;,
  &#39;me&#39;,
  &#39;appreciated&#39;,
  &#39;the&#39;,
  &#39;fact&#39;,
  &#39;that&#39;,
  &#39;it&#39;,
  &#39;was&#39;,
  &#39;not&#39;,
  &#39;the&#39;,
  &#39;standard&#39;,
  &#39;predictable&#39;,
  &#39;hollywood&#39;,
  &#39;fare&#39;,
  &#39;that&#39;,
  &#39;comes&#39;,
  &#39;out&#39;,
  &#39;every&#39;,
  &#39;year&#39;,
  &#39;eg&#39;],
 [&#39;the&#39;,
  &#39;spielberg&#39;,
  &#39;version&#39;,
  &#39;with&#39;,
  &#39;tom&#39;,
  &#39;cruise&#39;,
  &#39;that&#39;,
  &#39;had&#39;,
  &#39;only&#39;,
  &#39;the&#39;,
  &#39;slightest&#39;,
  &#39;resemblance&#39;,
  &#39;to&#39;,
  &#39;the&#39;,
  &#39;book&#39;],
 [&#39;obviously&#39;,
  &#39;everyone&#39;,
  &#39;looks&#39;,
  &#39;for&#39;,
  &#39;different&#39;,
  &#39;things&#39;,
  &#39;in&#39;,
  &#39;a&#39;,
  &#39;movie&#39;],
 [&#39;those&#39;,
  &#39;who&#39;,
  &#39;envision&#39;,
  &#39;themselves&#39;,
  &#39;as&#39;,
  &#39;amateur&#39;,
  &#39;critics&#39;,
  &#39;look&#39;,
  &#39;only&#39;,
  &#39;to&#39;,
  &#39;criticize&#39;,
  &#39;everything&#39;,
  &#39;they&#39;,
  &#39;can&#39;],
 [&#39;others&#39;,
  &#39;rate&#39;,
  &#39;a&#39;,
  &#39;movie&#39;,
  &#39;on&#39;,
  &#39;more&#39;,
  &#39;important&#39;,
  &#39;baseslike&#39;,
  &#39;being&#39;,
  &#39;entertained&#39;,
  &#39;which&#39;,
  &#39;is&#39;,
  &#39;why&#39;,
  &#39;most&#39;,
  &#39;people&#39;,
  &#39;never&#39;,
  &#39;agree&#39;,
  &#39;with&#39;,
  &#39;the&#39;,
  &#39;critics&#39;],
 [&#39;we&#39;,
  &#39;enjoyed&#39;,
  &#39;the&#39;,
  &#39;effort&#39;,
  &#39;mr&#39;,
  &#39;hines&#39;,
  &#39;put&#39;,
  &#39;into&#39;,
  &#39;being&#39;,
  &#39;faithful&#39;,
  &#39;to&#39;,
  &#39;hg&#39;],
 [&#39;wells&#39;,
  &#39;classic&#39;,
  &#39;novel&#39;,
  &#39;and&#39;,
  &#39;we&#39;,
  &#39;found&#39;,
  &#39;it&#39;,
  &#39;to&#39;,
  &#39;be&#39;,
  &#39;very&#39;,
  &#39;entertaining&#39;],
 [&#39;this&#39;,
  &#39;made&#39;,
  &#39;it&#39;,
  &#39;easy&#39;,
  &#39;to&#39;,
  &#39;overlook&#39;,
  &#39;what&#39;,
  &#39;the&#39;,
  &#39;critics&#39;,
  &#39;perceive&#39;,
  &#39;to&#39;,
  &#39;be&#39;,
  &#39;its&#39;,
  &#39;shortcomings&#39;]]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p3</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">p2</span><span class="p">:</span>
    <span class="n">p3</span><span class="o">+=</span><span class="n">i</span>
<span class="nb">print</span><span class="p">(</span><span class="n">p3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;the&#39;, &#39;classic&#39;, &#39;war&#39;, &#39;of&#39;, &#39;the&#39;, &#39;worlds&#39;, &#39;by&#39;, &#39;timothy&#39;, &#39;hines&#39;, &#39;is&#39;, &#39;a&#39;, &#39;very&#39;, &#39;entertaining&#39;, &#39;film&#39;, &#39;that&#39;, &#39;obviously&#39;, &#39;goes&#39;, &#39;to&#39;, &#39;great&#39;, &#39;effort&#39;, &#39;and&#39;, &#39;lengths&#39;, &#39;to&#39;, &#39;faithfully&#39;, &#39;recreate&#39;, &#39;h&#39;, &#39;g&#39;, &#39;wells&#39;, &#39;classic&#39;, &#39;book&#39;, &#39;mr&#39;, &#39;hines&#39;, &#39;succeeds&#39;, &#39;in&#39;, &#39;doing&#39;, &#39;so&#39;, &#39;i&#39;, &#39;and&#39;, &#39;those&#39;, &#39;who&#39;, &#39;watched&#39;, &#39;his&#39;, &#39;film&#39;, &#39;with&#39;, &#39;me&#39;, &#39;appreciated&#39;, &#39;the&#39;, &#39;fact&#39;, &#39;that&#39;, &#39;it&#39;, &#39;was&#39;, &#39;not&#39;, &#39;the&#39;, &#39;standard&#39;, &#39;predictable&#39;, &#39;hollywood&#39;, &#39;fare&#39;, &#39;that&#39;, &#39;comes&#39;, &#39;out&#39;, &#39;every&#39;, &#39;year&#39;, &#39;eg&#39;, &#39;the&#39;, &#39;spielberg&#39;, &#39;version&#39;, &#39;with&#39;, &#39;tom&#39;, &#39;cruise&#39;, &#39;that&#39;, &#39;had&#39;, &#39;only&#39;, &#39;the&#39;, &#39;slightest&#39;, &#39;resemblance&#39;, &#39;to&#39;, &#39;the&#39;, &#39;book&#39;, &#39;obviously&#39;, &#39;everyone&#39;, &#39;looks&#39;, &#39;for&#39;, &#39;different&#39;, &#39;things&#39;, &#39;in&#39;, &#39;a&#39;, &#39;movie&#39;, &#39;those&#39;, &#39;who&#39;, &#39;envision&#39;, &#39;themselves&#39;, &#39;as&#39;, &#39;amateur&#39;, &#39;critics&#39;, &#39;look&#39;, &#39;only&#39;, &#39;to&#39;, &#39;criticize&#39;, &#39;everything&#39;, &#39;they&#39;, &#39;can&#39;, &#39;others&#39;, &#39;rate&#39;, &#39;a&#39;, &#39;movie&#39;, &#39;on&#39;, &#39;more&#39;, &#39;important&#39;, &#39;baseslike&#39;, &#39;being&#39;, &#39;entertained&#39;, &#39;which&#39;, &#39;is&#39;, &#39;why&#39;, &#39;most&#39;, &#39;people&#39;, &#39;never&#39;, &#39;agree&#39;, &#39;with&#39;, &#39;the&#39;, &#39;critics&#39;, &#39;we&#39;, &#39;enjoyed&#39;, &#39;the&#39;, &#39;effort&#39;, &#39;mr&#39;, &#39;hines&#39;, &#39;put&#39;, &#39;into&#39;, &#39;being&#39;, &#39;faithful&#39;, &#39;to&#39;, &#39;hg&#39;, &#39;wells&#39;, &#39;classic&#39;, &#39;novel&#39;, &#39;and&#39;, &#39;we&#39;, &#39;found&#39;, &#39;it&#39;, &#39;to&#39;, &#39;be&#39;, &#39;very&#39;, &#39;entertaining&#39;, &#39;this&#39;, &#39;made&#39;, &#39;it&#39;, &#39;easy&#39;, &#39;to&#39;, &#39;overlook&#39;, &#39;what&#39;, &#39;the&#39;, &#39;critics&#39;, &#39;perceive&#39;, &#39;to&#39;, &#39;be&#39;, &#39;its&#39;, &#39;shortcomings&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span>

<span class="k">def</span> <span class="nf">mean_vector</span><span class="p">(</span><span class="n">sentence</span><span class="p">,</span> <span class="n">model</span><span class="p">):</span>
    <span class="n">total</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">model</span><span class="o">.</span><span class="n">vector_size</span><span class="p">,))</span>
    <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">sentence</span> <span class="p">:</span> 
        <span class="k">try</span><span class="p">:</span>
            <span class="n">add</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">wv</span><span class="p">[</span><span class="n">word</span><span class="p">]</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">add</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">model</span><span class="o">.</span><span class="n">vector_size</span><span class="p">,))</span>
        <span class="n">total</span> <span class="o">+=</span> <span class="n">model</span><span class="o">.</span><span class="n">wv</span><span class="p">[</span><span class="n">word</span><span class="p">]</span>
        <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="n">total</span><span class="o">/</span><span class="n">count</span>
    


<span class="k">def</span> <span class="nf">word2vec_features</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">model</span><span class="p">):</span>
    <span class="n">feats</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">sum_vectors</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">X</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">feats</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wv_train_feat</span> <span class="o">=</span> <span class="n">word2vec_features</span><span class="p">(</span><span class="n">X_train</span><span class="p">[</span><span class="s2">&quot;sentence&quot;</span><span class="p">],</span> <span class="n">model</span><span class="p">)</span>
<span class="n">wv_train_feat</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">moyenne</span> <span class="o">=</span> <span class="n">mean_vector</span><span class="p">(</span><span class="n">p3</span><span class="p">,</span> <span class="n">jerome</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p3</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;the&#39;,
 &#39;classic&#39;,
 &#39;war&#39;,
 &#39;of&#39;,
 &#39;the&#39;,
 &#39;worlds&#39;,
 &#39;by&#39;,
 &#39;timothy&#39;,
 &#39;hines&#39;,
 &#39;is&#39;,
 &#39;a&#39;,
 &#39;very&#39;,
 &#39;entertaining&#39;,
 &#39;film&#39;,
 &#39;that&#39;,
 &#39;obviously&#39;,
 &#39;goes&#39;,
 &#39;to&#39;,
 &#39;great&#39;,
 &#39;effort&#39;,
 &#39;and&#39;,
 &#39;lengths&#39;,
 &#39;to&#39;,
 &#39;faithfully&#39;,
 &#39;recreate&#39;,
 &#39;h&#39;,
 &#39;g&#39;,
 &#39;wells&#39;,
 &#39;classic&#39;,
 &#39;book&#39;,
 &#39;mr&#39;,
 &#39;hines&#39;,
 &#39;succeeds&#39;,
 &#39;in&#39;,
 &#39;doing&#39;,
 &#39;so&#39;,
 &#39;i&#39;,
 &#39;and&#39;,
 &#39;those&#39;,
 &#39;who&#39;,
 &#39;watched&#39;,
 &#39;his&#39;,
 &#39;film&#39;,
 &#39;with&#39;,
 &#39;me&#39;,
 &#39;appreciated&#39;,
 &#39;the&#39;,
 &#39;fact&#39;,
 &#39;that&#39;,
 &#39;it&#39;,
 &#39;was&#39;,
 &#39;not&#39;,
 &#39;the&#39;,
 &#39;standard&#39;,
 &#39;predictable&#39;,
 &#39;hollywood&#39;,
 &#39;fare&#39;,
 &#39;that&#39;,
 &#39;comes&#39;,
 &#39;out&#39;,
 &#39;every&#39;,
 &#39;year&#39;,
 &#39;eg&#39;,
 &#39;the&#39;,
 &#39;spielberg&#39;,
 &#39;version&#39;,
 &#39;with&#39;,
 &#39;tom&#39;,
 &#39;cruise&#39;,
 &#39;that&#39;,
 &#39;had&#39;,
 &#39;only&#39;,
 &#39;the&#39;,
 &#39;slightest&#39;,
 &#39;resemblance&#39;,
 &#39;to&#39;,
 &#39;the&#39;,
 &#39;book&#39;,
 &#39;obviously&#39;,
 &#39;everyone&#39;,
 &#39;looks&#39;,
 &#39;for&#39;,
 &#39;different&#39;,
 &#39;things&#39;,
 &#39;in&#39;,
 &#39;a&#39;,
 &#39;movie&#39;,
 &#39;those&#39;,
 &#39;who&#39;,
 &#39;envision&#39;,
 &#39;themselves&#39;,
 &#39;as&#39;,
 &#39;amateur&#39;,
 &#39;critics&#39;,
 &#39;look&#39;,
 &#39;only&#39;,
 &#39;to&#39;,
 &#39;criticize&#39;,
 &#39;everything&#39;,
 &#39;they&#39;,
 &#39;can&#39;,
 &#39;others&#39;,
 &#39;rate&#39;,
 &#39;a&#39;,
 &#39;movie&#39;,
 &#39;on&#39;,
 &#39;more&#39;,
 &#39;important&#39;,
 &#39;baseslike&#39;,
 &#39;being&#39;,
 &#39;entertained&#39;,
 &#39;which&#39;,
 &#39;is&#39;,
 &#39;why&#39;,
 &#39;most&#39;,
 &#39;people&#39;,
 &#39;never&#39;,
 &#39;agree&#39;,
 &#39;with&#39;,
 &#39;the&#39;,
 &#39;critics&#39;,
 &#39;we&#39;,
 &#39;enjoyed&#39;,
 &#39;the&#39;,
 &#39;effort&#39;,
 &#39;mr&#39;,
 &#39;hines&#39;,
 &#39;put&#39;,
 &#39;into&#39;,
 &#39;being&#39;,
 &#39;faithful&#39;,
 &#39;to&#39;,
 &#39;hg&#39;,
 &#39;wells&#39;,
 &#39;classic&#39;,
 &#39;novel&#39;,
 &#39;and&#39;,
 &#39;we&#39;,
 &#39;found&#39;,
 &#39;it&#39;,
 &#39;to&#39;,
 &#39;be&#39;,
 &#39;very&#39;,
 &#39;entertaining&#39;,
 &#39;this&#39;,
 &#39;made&#39;,
 &#39;it&#39;,
 &#39;easy&#39;,
 &#39;to&#39;,
 &#39;overlook&#39;,
 &#39;what&#39;,
 &#39;the&#39;,
 &#39;critics&#39;,
 &#39;perceive&#39;,
 &#39;to&#39;,
 &#39;be&#39;,
 &#39;its&#39;,
 &#39;shortcomings&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Import d&#39;une base word2vec en francais deja entrainee</span>

<span class="n">w2v</span> <span class="o">=</span> <span class="n">KeyedVectors</span><span class="o">.</span><span class="n">load_word2vec_format</span><span class="p">(</span><span class="s2">&quot;http://embeddings.net/frWac_non_lem_no_postag_no_phrase_200_cbow_cut100.bin&quot;</span><span class="p">,</span>
    <span class="n">binary</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">gaierror</span><span class="g g-Whitespace">                                  </span>Traceback (most recent call last)
<span class="nn">~\anaconda3\envs\mypy36\lib\site-packages\urllib3\connection.py</span> in <span class="ni">_new_conn</span><span class="nt">(self)</span>
<span class="g g-Whitespace">    </span><span class="mi">169</span>             <span class="n">conn</span> <span class="o">=</span> <span class="n">connection</span><span class="o">.</span><span class="n">create_connection</span><span class="p">(</span>
<span class="ne">--&gt; </span><span class="mi">170</span>                 <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_dns_host</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">port</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">timeout</span><span class="p">,</span> <span class="o">**</span><span class="n">extra_kw</span>
<span class="g g-Whitespace">    </span><span class="mi">171</span>             <span class="p">)</span>

<span class="nn">~\anaconda3\envs\mypy36\lib\site-packages\urllib3\util\connection.py</span> in <span class="ni">create_connection</span><span class="nt">(address, timeout, source_address, socket_options)</span>
<span class="g g-Whitespace">     </span><span class="mi">72</span> 
<span class="ne">---&gt; </span><span class="mi">73</span>     <span class="k">for</span> <span class="n">res</span> <span class="ow">in</span> <span class="n">socket</span><span class="o">.</span><span class="n">getaddrinfo</span><span class="p">(</span><span class="n">host</span><span class="p">,</span> <span class="n">port</span><span class="p">,</span> <span class="n">family</span><span class="p">,</span> <span class="n">socket</span><span class="o">.</span><span class="n">SOCK_STREAM</span><span class="p">):</span>
<span class="g g-Whitespace">     </span><span class="mi">74</span>         <span class="n">af</span><span class="p">,</span> <span class="n">socktype</span><span class="p">,</span> <span class="n">proto</span><span class="p">,</span> <span class="n">canonname</span><span class="p">,</span> <span class="n">sa</span> <span class="o">=</span> <span class="n">res</span>

<span class="nn">~\anaconda3\envs\mypy36\lib\socket.py</span> in <span class="ni">getaddrinfo</span><span class="nt">(host, port, family, type, proto, flags)</span>
<span class="g g-Whitespace">    </span><span class="mi">744</span>     <span class="n">addrlist</span> <span class="o">=</span> <span class="p">[]</span>
<span class="ne">--&gt; </span><span class="mi">745</span>     <span class="k">for</span> <span class="n">res</span> <span class="ow">in</span> <span class="n">_socket</span><span class="o">.</span><span class="n">getaddrinfo</span><span class="p">(</span><span class="n">host</span><span class="p">,</span> <span class="n">port</span><span class="p">,</span> <span class="n">family</span><span class="p">,</span> <span class="nb">type</span><span class="p">,</span> <span class="n">proto</span><span class="p">,</span> <span class="n">flags</span><span class="p">):</span>
<span class="g g-Whitespace">    </span><span class="mi">746</span>         <span class="n">af</span><span class="p">,</span> <span class="n">socktype</span><span class="p">,</span> <span class="n">proto</span><span class="p">,</span> <span class="n">canonname</span><span class="p">,</span> <span class="n">sa</span> <span class="o">=</span> <span class="n">res</span>

<span class="ne">gaierror</span>: [Errno 11002] getaddrinfo failed

<span class="n">During</span> <span class="n">handling</span> <span class="n">of</span> <span class="n">the</span> <span class="n">above</span> <span class="n">exception</span><span class="p">,</span> <span class="n">another</span> <span class="n">exception</span> <span class="n">occurred</span><span class="p">:</span>

<span class="ne">NewConnectionError</span><span class="g g-Whitespace">                        </span>Traceback (most recent call last)
<span class="nn">~\anaconda3\envs\mypy36\lib\site-packages\urllib3\connectionpool.py</span> in <span class="ni">urlopen</span><span class="nt">(self, method, url, body, headers, retries, redirect, assert_same_host, timeout, pool_timeout, release_conn, chunked, body_pos, **response_kw)</span>
<span class="g g-Whitespace">    </span><span class="mi">705</span>                 <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">,</span>
<span class="ne">--&gt; </span><span class="mi">706</span>                 <span class="n">chunked</span><span class="o">=</span><span class="n">chunked</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">707</span>             <span class="p">)</span>

<span class="nn">~\anaconda3\envs\mypy36\lib\site-packages\urllib3\connectionpool.py</span> in <span class="ni">_make_request</span><span class="nt">(self, conn, method, url, timeout, chunked, **httplib_request_kw)</span>
<span class="g g-Whitespace">    </span><span class="mi">393</span>             <span class="k">else</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">394</span>                 <span class="n">conn</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="n">method</span><span class="p">,</span> <span class="n">url</span><span class="p">,</span> <span class="o">**</span><span class="n">httplib_request_kw</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">395</span> 

<span class="nn">~\anaconda3\envs\mypy36\lib\site-packages\urllib3\connection.py</span> in <span class="ni">request</span><span class="nt">(self, method, url, body, headers)</span>
<span class="g g-Whitespace">    </span><span class="mi">233</span>             <span class="n">headers</span><span class="p">[</span><span class="s2">&quot;User-Agent&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">_get_default_user_agent</span><span class="p">()</span>
<span class="ne">--&gt; </span><span class="mi">234</span>         <span class="nb">super</span><span class="p">(</span><span class="n">HTTPConnection</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="n">method</span><span class="p">,</span> <span class="n">url</span><span class="p">,</span> <span class="n">body</span><span class="o">=</span><span class="n">body</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">235</span> 

<span class="nn">~\anaconda3\envs\mypy36\lib\http\client.py</span> in <span class="ni">request</span><span class="nt">(self, method, url, body, headers, encode_chunked)</span>
<span class="g g-Whitespace">   </span><span class="mi">1286</span>         <span class="sd">&quot;&quot;&quot;Send a complete request to the server.&quot;&quot;&quot;</span>
<span class="ne">-&gt; </span><span class="mi">1287</span>         <span class="bp">self</span><span class="o">.</span><span class="n">_send_request</span><span class="p">(</span><span class="n">method</span><span class="p">,</span> <span class="n">url</span><span class="p">,</span> <span class="n">body</span><span class="p">,</span> <span class="n">headers</span><span class="p">,</span> <span class="n">encode_chunked</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1288</span> 

<span class="nn">~\anaconda3\envs\mypy36\lib\http\client.py</span> in <span class="ni">_send_request</span><span class="nt">(self, method, url, body, headers, encode_chunked)</span>
<span class="g g-Whitespace">   </span><span class="mi">1332</span>             <span class="n">body</span> <span class="o">=</span> <span class="n">_encode</span><span class="p">(</span><span class="n">body</span><span class="p">,</span> <span class="s1">&#39;body&#39;</span><span class="p">)</span>
<span class="ne">-&gt; </span><span class="mi">1333</span>         <span class="bp">self</span><span class="o">.</span><span class="n">endheaders</span><span class="p">(</span><span class="n">body</span><span class="p">,</span> <span class="n">encode_chunked</span><span class="o">=</span><span class="n">encode_chunked</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1334</span> 

<span class="nn">~\anaconda3\envs\mypy36\lib\http\client.py</span> in <span class="ni">endheaders</span><span class="nt">(self, message_body, encode_chunked)</span>
<span class="g g-Whitespace">   </span><span class="mi">1281</span>             <span class="k">raise</span> <span class="n">CannotSendHeader</span><span class="p">()</span>
<span class="ne">-&gt; </span><span class="mi">1282</span>         <span class="bp">self</span><span class="o">.</span><span class="n">_send_output</span><span class="p">(</span><span class="n">message_body</span><span class="p">,</span> <span class="n">encode_chunked</span><span class="o">=</span><span class="n">encode_chunked</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1283</span> 

<span class="nn">~\anaconda3\envs\mypy36\lib\http\client.py</span> in <span class="ni">_send_output</span><span class="nt">(self, message_body, encode_chunked)</span>
<span class="g g-Whitespace">   </span><span class="mi">1041</span>         <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">_buffer</span><span class="p">[:]</span>
<span class="ne">-&gt; </span><span class="mi">1042</span>         <span class="bp">self</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1043</span> 

<span class="nn">~\anaconda3\envs\mypy36\lib\http\client.py</span> in <span class="ni">send</span><span class="nt">(self, data)</span>
<span class="g g-Whitespace">    </span><span class="mi">979</span>             <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">auto_open</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">980</span>                 <span class="bp">self</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span>
<span class="g g-Whitespace">    </span><span class="mi">981</span>             <span class="k">else</span><span class="p">:</span>

<span class="nn">~\anaconda3\envs\mypy36\lib\site-packages\urllib3\connection.py</span> in <span class="ni">connect</span><span class="nt">(self)</span>
<span class="g g-Whitespace">    </span><span class="mi">199</span>     <span class="k">def</span> <span class="nf">connect</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="ne">--&gt; </span><span class="mi">200</span>         <span class="n">conn</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_new_conn</span><span class="p">()</span>
<span class="g g-Whitespace">    </span><span class="mi">201</span>         <span class="bp">self</span><span class="o">.</span><span class="n">_prepare_conn</span><span class="p">(</span><span class="n">conn</span><span class="p">)</span>

<span class="nn">~\anaconda3\envs\mypy36\lib\site-packages\urllib3\connection.py</span> in <span class="ni">_new_conn</span><span class="nt">(self)</span>
<span class="g g-Whitespace">    </span><span class="mi">181</span>             <span class="k">raise</span> <span class="n">NewConnectionError</span><span class="p">(</span>
<span class="ne">--&gt; </span><span class="mi">182</span>                 <span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;Failed to establish a new connection: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">e</span>
<span class="g g-Whitespace">    </span><span class="mi">183</span>             <span class="p">)</span>

<span class="ne">NewConnectionError</span>: &lt;urllib3.connection.HTTPConnection object at 0x0000028E9520F7B8&gt;: Failed to establish a new connection: [Errno 11002] getaddrinfo failed

<span class="n">During</span> <span class="n">handling</span> <span class="n">of</span> <span class="n">the</span> <span class="n">above</span> <span class="n">exception</span><span class="p">,</span> <span class="n">another</span> <span class="n">exception</span> <span class="n">occurred</span><span class="p">:</span>

<span class="ne">MaxRetryError</span><span class="g g-Whitespace">                             </span>Traceback (most recent call last)
<span class="nn">~\anaconda3\envs\mypy36\lib\site-packages\requests\adapters.py</span> in <span class="ni">send</span><span class="nt">(self, request, stream, timeout, verify, cert, proxies)</span>
<span class="g g-Whitespace">    </span><span class="mi">448</span>                     <span class="n">retries</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">max_retries</span><span class="p">,</span>
<span class="ne">--&gt; </span><span class="mi">449</span>                     <span class="n">timeout</span><span class="o">=</span><span class="n">timeout</span>
<span class="g g-Whitespace">    </span><span class="mi">450</span>                 <span class="p">)</span>

<span class="nn">~\anaconda3\envs\mypy36\lib\site-packages\urllib3\connectionpool.py</span> in <span class="ni">urlopen</span><span class="nt">(self, method, url, body, headers, retries, redirect, assert_same_host, timeout, pool_timeout, release_conn, chunked, body_pos, **response_kw)</span>
<span class="g g-Whitespace">    </span><span class="mi">755</span>             <span class="n">retries</span> <span class="o">=</span> <span class="n">retries</span><span class="o">.</span><span class="n">increment</span><span class="p">(</span>
<span class="ne">--&gt; </span><span class="mi">756</span>                 <span class="n">method</span><span class="p">,</span> <span class="n">url</span><span class="p">,</span> <span class="n">error</span><span class="o">=</span><span class="n">e</span><span class="p">,</span> <span class="n">_pool</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">_stacktrace</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">exc_info</span><span class="p">()[</span><span class="mi">2</span><span class="p">]</span>
<span class="g g-Whitespace">    </span><span class="mi">757</span>             <span class="p">)</span>

<span class="nn">~\anaconda3\envs\mypy36\lib\site-packages\urllib3\util\retry.py</span> in <span class="ni">increment</span><span class="nt">(self, method, url, response, error, _pool, _stacktrace)</span>
<span class="g g-Whitespace">    </span><span class="mi">572</span>         <span class="k">if</span> <span class="n">new_retry</span><span class="o">.</span><span class="n">is_exhausted</span><span class="p">():</span>
<span class="ne">--&gt; </span><span class="mi">573</span>             <span class="k">raise</span> <span class="n">MaxRetryError</span><span class="p">(</span><span class="n">_pool</span><span class="p">,</span> <span class="n">url</span><span class="p">,</span> <span class="n">error</span> <span class="ow">or</span> <span class="n">ResponseError</span><span class="p">(</span><span class="n">cause</span><span class="p">))</span>
<span class="g g-Whitespace">    </span><span class="mi">574</span> 

<span class="ne">MaxRetryError</span>: HTTPConnectionPool(host=&#39;embeddings.net&#39;, port=80): Max retries exceeded with url: /frWac_non_lem_no_postag_no_phrase_200_cbow_cut100.bin (Caused by NewConnectionError(&#39;&lt;urllib3.connection.HTTPConnection object at 0x0000028E9520F7B8&gt;: Failed to establish a new connection: [Errno 11002] getaddrinfo failed&#39;,))

<span class="n">During</span> <span class="n">handling</span> <span class="n">of</span> <span class="n">the</span> <span class="n">above</span> <span class="n">exception</span><span class="p">,</span> <span class="n">another</span> <span class="n">exception</span> <span class="n">occurred</span><span class="p">:</span>

<span class="ne">ConnectionError</span><span class="g g-Whitespace">                           </span>Traceback (most recent call last)
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">8642</span><span class="n">bd85a688</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> 
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="n">w2v</span> <span class="o">=</span> <span class="n">KeyedVectors</span><span class="o">.</span><span class="n">load_word2vec_format</span><span class="p">(</span><span class="s2">&quot;http://embeddings.net/frWac_non_lem_no_postag_no_phrase_200_cbow_cut100.bin&quot;</span><span class="p">,</span>
<span class="ne">----&gt; </span><span class="mi">4</span>     <span class="n">binary</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="nn">~\anaconda3\envs\mypy36\lib\site-packages\gensim\models\keyedvectors.py</span> in <span class="ni">load_word2vec_format</span><span class="nt">(cls, fname, fvocab, binary, encoding, unicode_errors, limit, datatype)</span>
<span class="g g-Whitespace">   </span><span class="mi">1547</span>         <span class="k">return</span> <span class="n">_load_word2vec_format</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">1548</span>             <span class="bp">cls</span><span class="p">,</span> <span class="n">fname</span><span class="p">,</span> <span class="n">fvocab</span><span class="o">=</span><span class="n">fvocab</span><span class="p">,</span> <span class="n">binary</span><span class="o">=</span><span class="n">binary</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="n">encoding</span><span class="p">,</span> <span class="n">unicode_errors</span><span class="o">=</span><span class="n">unicode_errors</span><span class="p">,</span>
<span class="ne">-&gt; </span><span class="mi">1549</span>             <span class="n">limit</span><span class="o">=</span><span class="n">limit</span><span class="p">,</span> <span class="n">datatype</span><span class="o">=</span><span class="n">datatype</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1550</span> 
<span class="g g-Whitespace">   </span><span class="mi">1551</span>     <span class="nd">@classmethod</span>

<span class="nn">~\anaconda3\envs\mypy36\lib\site-packages\gensim\models\utils_any2vec.py</span> in <span class="ni">_load_word2vec_format</span><span class="nt">(cls, fname, fvocab, binary, encoding, unicode_errors, limit, datatype, binary_chunk_size)</span>
<span class="g g-Whitespace">    </span><span class="mi">273</span> 
<span class="g g-Whitespace">    </span><span class="mi">274</span>     <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;loading projection weights from </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">fname</span><span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">275</span>     <span class="k">with</span> <span class="n">utils</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fin</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">276</span>         <span class="n">header</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">to_unicode</span><span class="p">(</span><span class="n">fin</span><span class="o">.</span><span class="n">readline</span><span class="p">(),</span> <span class="n">encoding</span><span class="o">=</span><span class="n">encoding</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">277</span>         <span class="n">vocab_size</span><span class="p">,</span> <span class="n">vector_size</span> <span class="o">=</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">header</span><span class="o">.</span><span class="n">split</span><span class="p">())</span>  <span class="c1"># throws for invalid file format</span>

<span class="nn">~\anaconda3\envs\mypy36\lib\site-packages\smart_open\smart_open_lib.py</span> in <span class="ni">open</span><span class="nt">(uri, mode, buffering, encoding, errors, newline, closefd, opener, ignore_ext, transport_params)</span>
<span class="g g-Whitespace">    </span><span class="mi">219</span>         <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="n">ve</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="g g-Whitespace">    </span><span class="mi">220</span> 
<span class="ne">--&gt; </span><span class="mi">221</span>     <span class="n">binary</span> <span class="o">=</span> <span class="n">_open_binary_stream</span><span class="p">(</span><span class="n">uri</span><span class="p">,</span> <span class="n">binary_mode</span><span class="p">,</span> <span class="n">transport_params</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">222</span>     <span class="k">if</span> <span class="n">ignore_ext</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">223</span>         <span class="n">decompressed</span> <span class="o">=</span> <span class="n">binary</span>

<span class="nn">~\anaconda3\envs\mypy36\lib\site-packages\smart_open\smart_open_lib.py</span> in <span class="ni">_open_binary_stream</span><span class="nt">(uri, mode, transport_params)</span>
<span class="g g-Whitespace">    </span><span class="mi">381</span>     <span class="n">scheme</span> <span class="o">=</span> <span class="n">_sniff_scheme</span><span class="p">(</span><span class="n">uri</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">382</span>     <span class="n">submodule</span> <span class="o">=</span> <span class="n">transport</span><span class="o">.</span><span class="n">get_transport</span><span class="p">(</span><span class="n">scheme</span><span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">383</span>     <span class="n">fobj</span> <span class="o">=</span> <span class="n">submodule</span><span class="o">.</span><span class="n">open_uri</span><span class="p">(</span><span class="n">uri</span><span class="p">,</span> <span class="n">mode</span><span class="p">,</span> <span class="n">transport_params</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">384</span>     <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">fobj</span><span class="p">,</span> <span class="s1">&#39;name&#39;</span><span class="p">):</span>
<span class="g g-Whitespace">    </span><span class="mi">385</span>         <span class="n">fobj</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">uri</span>

<span class="nn">~\anaconda3\envs\mypy36\lib\site-packages\smart_open\http.py</span> in <span class="ni">open_uri</span><span class="nt">(uri, mode, transport_params)</span>
<span class="g g-Whitespace">     </span><span class="mi">47</span> <span class="k">def</span> <span class="nf">open_uri</span><span class="p">(</span><span class="n">uri</span><span class="p">,</span> <span class="n">mode</span><span class="p">,</span> <span class="n">transport_params</span><span class="p">):</span>
<span class="g g-Whitespace">     </span><span class="mi">48</span>     <span class="n">kwargs</span> <span class="o">=</span> <span class="n">smart_open</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">check_kwargs</span><span class="p">(</span><span class="nb">open</span><span class="p">,</span> <span class="n">transport_params</span><span class="p">)</span>
<span class="ne">---&gt; </span><span class="mi">49</span>     <span class="k">return</span> <span class="nb">open</span><span class="p">(</span><span class="n">uri</span><span class="p">,</span> <span class="n">mode</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">50</span> 
<span class="g g-Whitespace">     </span><span class="mi">51</span> 

<span class="nn">~\anaconda3\envs\mypy36\lib\site-packages\smart_open\http.py</span> in <span class="ni">open</span><span class="nt">(uri, mode, kerberos, user, password, headers)</span>
<span class="g g-Whitespace">     </span><span class="mi">81</span>         <span class="n">fobj</span> <span class="o">=</span> <span class="n">SeekableBufferedInputBase</span><span class="p">(</span>
<span class="g g-Whitespace">     </span><span class="mi">82</span>             <span class="n">uri</span><span class="p">,</span> <span class="n">mode</span><span class="p">,</span> <span class="n">kerberos</span><span class="o">=</span><span class="n">kerberos</span><span class="p">,</span>
<span class="ne">---&gt; </span><span class="mi">83</span>             <span class="n">user</span><span class="o">=</span><span class="n">user</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="n">password</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span>
<span class="g g-Whitespace">     </span><span class="mi">84</span>         <span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">85</span>         <span class="n">fobj</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">urlparse</span><span class="p">(</span><span class="n">uri</span><span class="p">)</span><span class="o">.</span><span class="n">path</span><span class="p">)</span>

<span class="nn">~\anaconda3\envs\mypy36\lib\site-packages\smart_open\http.py</span> in <span class="ni">__init__</span><span class="nt">(self, url, mode, buffer_size, kerberos, user, password, headers)</span>
<span class="g g-Whitespace">    </span><span class="mi">225</span>         <span class="bp">self</span><span class="o">.</span><span class="n">buffer_size</span> <span class="o">=</span> <span class="n">buffer_size</span>
<span class="g g-Whitespace">    </span><span class="mi">226</span>         <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">=</span> <span class="n">mode</span>
<span class="ne">--&gt; </span><span class="mi">227</span>         <span class="bp">self</span><span class="o">.</span><span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_partial_request</span><span class="p">()</span>
<span class="g g-Whitespace">    </span><span class="mi">228</span> 
<span class="g g-Whitespace">    </span><span class="mi">229</span>         <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">response</span><span class="o">.</span><span class="n">ok</span><span class="p">:</span>

<span class="nn">~\anaconda3\envs\mypy36\lib\site-packages\smart_open\http.py</span> in <span class="ni">_partial_request</span><span class="nt">(self, start_pos)</span>
<span class="g g-Whitespace">    </span><span class="mi">308</span>             <span class="bp">self</span><span class="o">.</span><span class="n">headers</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;range&quot;</span><span class="p">:</span> <span class="n">smart_open</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">make_range_string</span><span class="p">(</span><span class="n">start_pos</span><span class="p">)})</span>
<span class="g g-Whitespace">    </span><span class="mi">309</span> 
<span class="ne">--&gt; </span><span class="mi">310</span>         <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">url</span><span class="p">,</span> <span class="n">auth</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">auth</span><span class="p">,</span> <span class="n">stream</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">headers</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">311</span>         <span class="k">return</span> <span class="n">response</span>

<span class="nn">~\anaconda3\envs\mypy36\lib\site-packages\requests\api.py</span> in <span class="ni">get</span><span class="nt">(url, params, **kwargs)</span>
<span class="g g-Whitespace">     </span><span class="mi">74</span> 
<span class="g g-Whitespace">     </span><span class="mi">75</span>     <span class="n">kwargs</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s1">&#39;allow_redirects&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
<span class="ne">---&gt; </span><span class="mi">76</span>     <span class="k">return</span> <span class="n">request</span><span class="p">(</span><span class="s1">&#39;get&#39;</span><span class="p">,</span> <span class="n">url</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">77</span> 
<span class="g g-Whitespace">     </span><span class="mi">78</span> 

<span class="nn">~\anaconda3\envs\mypy36\lib\site-packages\requests\api.py</span> in <span class="ni">request</span><span class="nt">(method, url, **kwargs)</span>
<span class="g g-Whitespace">     </span><span class="mi">59</span>     <span class="c1"># cases, and look like a memory leak in others.</span>
<span class="g g-Whitespace">     </span><span class="mi">60</span>     <span class="k">with</span> <span class="n">sessions</span><span class="o">.</span><span class="n">Session</span><span class="p">()</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
<span class="ne">---&gt; </span><span class="mi">61</span>         <span class="k">return</span> <span class="n">session</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="n">method</span><span class="p">,</span> <span class="n">url</span><span class="o">=</span><span class="n">url</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">62</span> 
<span class="g g-Whitespace">     </span><span class="mi">63</span> 

<span class="nn">~\anaconda3\envs\mypy36\lib\site-packages\requests\sessions.py</span> in <span class="ni">request</span><span class="nt">(self, method, url, params, data, headers, cookies, files, auth, timeout, allow_redirects, proxies, hooks, stream, verify, cert, json)</span>
<span class="g g-Whitespace">    </span><span class="mi">540</span>         <span class="p">}</span>
<span class="g g-Whitespace">    </span><span class="mi">541</span>         <span class="n">send_kwargs</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">settings</span><span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">542</span>         <span class="n">resp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">prep</span><span class="p">,</span> <span class="o">**</span><span class="n">send_kwargs</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">543</span> 
<span class="g g-Whitespace">    </span><span class="mi">544</span>         <span class="k">return</span> <span class="n">resp</span>

<span class="nn">~\anaconda3\envs\mypy36\lib\site-packages\requests\sessions.py</span> in <span class="ni">send</span><span class="nt">(self, request, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">653</span> 
<span class="g g-Whitespace">    </span><span class="mi">654</span>         <span class="c1"># Send the request</span>
<span class="ne">--&gt; </span><span class="mi">655</span>         <span class="n">r</span> <span class="o">=</span> <span class="n">adapter</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">656</span> 
<span class="g g-Whitespace">    </span><span class="mi">657</span>         <span class="c1"># Total elapsed time of the request (approximately)</span>

<span class="nn">~\anaconda3\envs\mypy36\lib\site-packages\requests\adapters.py</span> in <span class="ni">send</span><span class="nt">(self, request, stream, timeout, verify, cert, proxies)</span>
<span class="g g-Whitespace">    </span><span class="mi">514</span>                 <span class="k">raise</span> <span class="n">SSLError</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">515</span> 
<span class="ne">--&gt; </span><span class="mi">516</span>             <span class="k">raise</span> <span class="ne">ConnectionError</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">517</span> 
<span class="g g-Whitespace">    </span><span class="mi">518</span>         <span class="k">except</span> <span class="n">ClosedPoolError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>

<span class="ne">ConnectionError</span>: HTTPConnectionPool(host=&#39;embeddings.net&#39;, port=80): Max retries exceeded with url: /frWac_non_lem_no_postag_no_phrase_200_cbow_cut100.bin (Caused by NewConnectionError(&#39;&lt;urllib3.connection.HTTPConnection object at 0x0000028E9520F7B8&gt;: Failed to establish a new connection: [Errno 11002] getaddrinfo failed&#39;,))
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># On commence par utiliser notre pipeline définie plus haut</span>

<span class="n">phrases_propres</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">phrase</span> <span class="ow">in</span> <span class="n">phrases</span><span class="p">:</span>
    <span class="n">phrases_propres</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">nlp_pipeline</span><span class="p">(</span><span class="n">phrase</span><span class="p">))</span>

<span class="c1"># Nous devons séparer les phrases en liste de mots</span>

<span class="n">phrases_split</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">phrase</span> <span class="ow">in</span> <span class="n">phrases_propres</span><span class="p">:</span>
    <span class="n">phrases_split</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">phrase</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">))</span>

<span class="c1"># C&#39;est là que Word2vec intervient</span>
<span class="n">X</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">phrase</span> <span class="ow">in</span> <span class="n">phrases_split</span><span class="p">:</span>
    <span class="n">vec_phrase</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">mot</span> <span class="ow">in</span> <span class="n">phrase</span><span class="p">:</span>
        <span class="n">vec_phrase</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">w2v</span><span class="o">.</span><span class="n">wv</span><span class="p">[</span><span class="n">mot</span><span class="p">])</span>
    <span class="n">X</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">vec_phrase</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
    
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">kclusterer</span> <span class="o">=</span> <span class="n">KMeansClusterer</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">distance</span><span class="o">=</span><span class="n">nltk</span><span class="o">.</span><span class="n">cluster</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">cosine_distance</span><span class="p">,</span> <span class="n">repeats</span><span class="o">=</span><span class="mi">25</span><span class="p">)</span>
<span class="n">clusters</span> <span class="o">=</span> <span class="n">kclusterer</span><span class="o">.</span><span class="n">cluster</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">assign_clusters</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span> <span class="p">(</span><span class="n">clusters</span><span class="p">)</span>

<span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">phrase</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">phrases</span><span class="p">):</span>    
    <span class="nb">print</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">clusters</span><span class="p">[</span><span class="n">index</span><span class="p">])</span> <span class="o">+</span> <span class="s2">&quot;:&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">phrase</span><span class="p">))</span>

<span class="n">kmeans</span> <span class="o">=</span> <span class="n">cluster</span><span class="o">.</span><span class="n">KMeans</span><span class="p">(</span><span class="n">n_clusters</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">kmeans</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
  
<span class="n">labels</span> <span class="o">=</span> <span class="n">kmeans</span><span class="o">.</span><span class="n">labels_</span>
<span class="n">centroids</span> <span class="o">=</span> <span class="n">kmeans</span><span class="o">.</span><span class="n">cluster_centers_</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lili</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">8</span><span class="p">]),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">9</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">7</span><span class="p">]),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">])]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">type</span><span class="p">(</span><span class="n">lili</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>list
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lili</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[array([1, 2, 3]), array([4, 6, 8]), array([9, 8, 7]), array([5, 5, 5])]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">B</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">lili</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">B</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[1, 2, 3],
       [4, 6, 8],
       [9, 8, 7],
       [5, 5, 5]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">B</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(4, 3)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">type</span><span class="p">(</span><span class="n">lili</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>list
</pre></div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./pages\NLP\TAL3"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
        <div class='prev-next-bottom'>
            

        </div>
        
        </div>
    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By The Jupyter Book community<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="../../../_static/js/index.d3f166471bb80abb5163.js"></script>


    
  </body>
</html>